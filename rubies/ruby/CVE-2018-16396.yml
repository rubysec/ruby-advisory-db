---
engine: ruby
cve: 2018-16396
ghsa: xh4x-ph6p-vmxh
url: https://www.ruby-lang.org/en/news/2018/10/17/not-propagated-taint-flag-in-some-formats-of-pack-cve-2018-16396/
title: Tainted flags not always propogated in Array#pack and String#unpack
date: 2018-10-17
description: |
  In `Array#pack` and `String#unpack` with some formats, the tainted flags of
  the original data are not propagated to the returned string/array.

  `Array#pack` method converts the receiverâ€™s contents into a string with
  specified format. If the receiver contains some tainted objects, the
  returned string also should be tainted. `String#unpack` method which
  converts the receiver into an array also should propagate its tainted flag
  to the objects contained in the returned array. But, with `B`, `b`, `H` and
  `h` directives, the tainted flags are not propagated. So, if a script
  processes unreliable inputs by `Array#pack` and/or `String#unpack` with these
  directives and checks the reliability with tainted flags, the check might be
  wrong.

  All users running an affected release should upgrade immediately.
cvss_v2: 6.0
cvss_v3: 8.1
patched_versions:
  - "~> 2.3.8"
  - "~> 2.4.5"
  - "~> 2.5.2"
  - ">= 2.6.0-preview3"
related:
  url:
    - https://nvd.nist.gov/vuln/detail/CVE-2018-16396
    - https://www.ruby-lang.org/en/news/2018/10/17/ruby-2-3-8-released
    - https://www.ruby-lang.org/en/news/2018/10/17/ruby-2-4-5-released
    - https://www.ruby-lang.org/en/news/2018/10/17/ruby-2-5-2-released
    - https://www.ruby-lang.org/en/news/2018/11/06/ruby-2-6-0-preview3-released
    - https://www.ruby-lang.org/en/news/2018/10/17/not-propagated-taint-flag-in-some-formats-of-pack-cve-2018-16396
    - https://hackerone.com/reports/385070
    - https://ubuntu.com/security/notices/USN-3808-1
    - https://www.debian.org/security/2018/dsa-4332
    - https://lists.debian.org/debian-lts-announce/2018/10/msg00020.html
    - https://access.redhat.com/errata/RHSA-2018:3729
    - https://access.redhat.com/errata/RHSA-2018:3730
    - https://access.redhat.com/errata/RHSA-2018:3731
    - https://access.redhat.com/errata/RHSA-2019:2028
    - http://lists.opensuse.org/opensuse-security-announce/2019-07/msg00036.html
    - https://security.netapp.com/advisory/ntap-20190221-0002/
    - https://github.com/advisories/GHSA-xh4x-ph6p-vmxh
