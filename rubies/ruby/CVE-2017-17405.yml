---
engine: ruby
cve: 2017-17405
ghsa: https://github.com/advisories/GHSA-q23r-c9rf-97q3
url: https://nvd.nist.gov/vuln/detail/CVE-2017-17405
title: Command injection vulnerability in Net::FTP
date: 2017-12-14
description: |
  There is a command injection vulnerability in Net::FTP bundled with Ruby.

  `Net::FTP#get`, `getbinaryfile`, `gettextfile`, `put`, `putbinaryfile`, and
  `puttextfile` use `Kernel#open` to open a local file. If the `localfile`
  argument starts with the pipe character `"|"`, the command following the
  pipe character is executed. The default value of `localfile` is
  `File.basename(remotefile)`, so malicious FTP servers could cause arbitrary
  command execution.

  All users running an affected release should upgrade immediately.
cvss_v2: 9.3
cvss_v3: 8.8
patched_versions:
  - "~> 2.2.9"
  - "~> 2.3.6"
  - "~> 2.4.3"
  - "> 2.5.0.preview.1"
related:
  url:
    - https://nvd.nist.gov/vuln/detail/CVE-2017-17405
    - https://www.ruby-lang.org/en/news/2017/12/14/ruby-2-4-3-released
    - https://www.ruby-lang.org/en/news/2017/12/14/ruby-2-3-6-released
    - https://www.ruby-lang.org/en/news/2017/12/14/ruby-2-2-9-released
    - https://www.ruby-lang.org/en/news/2017/12/14/net-ftp-command-injection-cve-2017-17405
    - https://www.exploit-db.com/exploits/43381
    - https://lists.debian.org/debian-security-announce/2018/msg00188.html
    - https://lists.debian.org/debian-lts-announce/2017/12/msg00024.html
    - https://lists.debian.org/debian-lts-announce/2017/12/msg00025.html
    - https://lists.debian.org/debian-lts-announce/2018/07/msg00012.html
    - https://access.redhat.com/errata/RHSA-2018:0378
    - https://access.redhat.com/errata/RHSA-2018:0583
    - https://access.redhat.com/errata/RHSA-2018:0584
    - https://access.redhat.com/errata/RHSA-2018:0585
    - https://access.redhat.com/errata/RHSA-2019:2806
    - https://github.com/advisories/GHSA-q23r-c9rf-97q3
