---
engine: ruby
cve: 2018-8778
ghsa: wvhq-ch4h-8pwr
url: https://www.ruby-lang.org/en/news/2018/03/28/buffer-under-read-unpack-cve-2018-8778/
title: Buffer under-read in String#unpack
date: 2018-03-28
description: |
  `String#unpack` receives format specifiers as its parameter, and can be
  specified the position of parsing the data by the specifier `@`. If a big
  number is passed with `@`, the number is treated as the negative value, and
  out-of-buffer read is occurred. So, if a script accepts an external input as
  the argument of `String#unpack`, the attacker can read data on heaps.

  All users running an affected release should upgrade immediately.
cvss_v2: 5.0
cvss_v3: 7.5
patched_versions:
  - "~> 2.2.10"
  - "~> 2.3.7"
  - "~> 2.4.4"
  - "~> 2.5.1"
  - "> 2.6.0-preview1"
related:
  url:
    - https://nvd.nist.gov/vuln/detail/CVE-2018-8778
    - https://www.ruby-lang.org/en/news/2018/03/28/buffer-under-read-unpack-cve-2018-8778
    - https://www.ruby-lang.org/en/news/2018/03/28/ruby-2-2-10-released
    - https://www.ruby-lang.org/en/news/2018/03/28/ruby-2-3-7-released
    - https://www.ruby-lang.org/en/news/2018/03/28/ruby-2-4-4-released
    - https://www.ruby-lang.org/en/news/2018/03/28/ruby-2-5-1-released
    - https://www.ruby-lang.org/en/news/2018/11/06/ruby-2-6-0-preview3-released
    - https://ubuntu.com/security/notices/USN-3626-1
    - https://lists.debian.org/debian-lts-announce/2018/04/msg00023.html
    - https://lists.debian.org/debian-lts-announce/2018/04/msg00024.html
    - https://lists.debian.org/debian-lts-announce/2018/07/msg00012.html
    - https://www.debian.org/security/2018/dsa-4259
    - https://access.redhat.com/errata/RHSA-2018:3729
    - https://access.redhat.com/errata/RHSA-2018:3730
    - https://access.redhat.com/errata/RHSA-2018:3731
    - https://access.redhat.com/errata/RHSA-2019:2028
    - http://lists.opensuse.org/opensuse-security-announce/2019-07/msg00036.html
    - https://github.com/advisories/GHSA-wvhq-ch4h-8pwr
