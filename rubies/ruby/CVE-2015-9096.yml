---
engine: ruby
cve: 2015-9096
ghsa: 2h3c-5vqm-gqfh
url: https://hackerone.com/reports/137631
title: SMTP command injection
date: 2015-12-09
cvss_v2: 4.3
cvss_v3: 6.1
description: |
  Net::SMTP is vulnerable to SMTP command injection via CRLF sequences
  in a RCPT TO or MAIL FROM command, as demonstrated by CRLF sequences
  immediately before and after a DATA substring.

  Applications that validate email address format are not affected by this
  vulnerability.

  The injection attack is described in Terada, Takeshi. "SMTP Injection via
  Recipient Email Addresses." 2015. The attacks described in the paper
  (Terada, p. 4) can be applied to without any modification.

  ## RELEASE INFO
  Backported to
    - 2.2: PR#1648
    - 2.3: PR#1647
patched_versions:
  - "~> 2.3.5"
  - ">= 2.4.0"
related:
  url:
    - https://nvd.nist.gov/vuln/detail/CVE-2015-9096
    - https://github.com/ruby/ruby/commit/0827a7e52ba3d957a634b063bf5a391239b9ffee
    - https://github.com/ruby/ruby/pull/1648
    - https://github.com/ruby/ruby/pull/1647
    - https://hackerone.com/reports/137631
    - https://lists.debian.org/debian-lts-announce/2018/07/msg00012.html
    - https://www.debian.org/security/2017/dsa-3966
    - http://www.mbsd.jp/Whitepaper/smtpi.pdf
    - https://github.com/mikel/mail/pull/1097
    - https://github.com/advisories/GHSA-2h3c-5vqm-gqfh
