---
engine: ruby
cve: 2016-2338
ghsa: r46x-xjwr-8v2g
url: https://github.com/advisories/GHSA-r46x-xjwr-8v2g
title: Exploitable heap overflow vulnerability exists
  in Ruby's Psych::Emitter start_document function
date: 2022-09-28
description: |
  An exploitable heap overflow vulnerability exists in the
  Psych::Emitter start_document function of Ruby. In Psych::Emitter
  start_document function heap buffer "head" allocation is made
  based on tags array length. Specially constructed object passed
  as element of tags array can increase this array size after
  mentioned allocation and cause heap overflow.

  - "Ruby versions 2.2.2 (4/13/2015) and 2.3.0 (12/25/2015)
     are susceptible"
cvss_v3: 9.8
patched_versions:
  - "~> 2.3.1"
  - ">= 2.4.0"
related:
  url:
    - https://nvd.nist.gov/vuln/detail/CVE-2016-2338
    - https://lists.debian.org/debian-lts-announce/2020/03/msg00032.html
    - http://www.talosintelligence.com/reports/TALOS-2016-0032
    - https://security.netapp.com/advisory/ntap-20221228-0005
    - https://cve.reconshell.com/cve/CVE-2016-2338
    - https://alas.aws.amazon.com/AL2/ALAS2-2025-2990.html
    - https://github.com/advisories/GHSA-r46x-xjwr-8v2g
