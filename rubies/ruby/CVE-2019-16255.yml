---
engine: ruby
cve: 2019-16255
ghsa: ph7w-p94x-9vvw
url: https://nvd.nist.gov/vuln/detail/CVE-2019-16255
title: A code injection vulnerability of Shell#[] and Shell#test
date: 2019-10-01
description: |
  Shell#[] and its alias Shell#test defined in lib/shell.rb allow code
  injection if the first argument (aka the “command” argument) is untrusted
  data. An attacker can exploit this to call an arbitrary Ruby method.

  Note that passing untrusted data to methods of Shell is dangerous in general.
  Users must never do it. However, we treat this particular case as a
  vulnerability because the purpose of Shell#[] and Shell#[] is considered file
  testing.
cvss_v2: 6.8
cvss_v3: 8.1
patched_versions:
  - "~> 2.4.8"
  - "~> 2.5.7"
  - "~> 2.6.5"
  - "> 2.7.0-preview1"
related:
  url:
    - https://nvd.nist.gov/vuln/detail/CVE-2019-16255
    - https://www.ruby-lang.org/en/news/2019/10/01/ruby-2-6-5-released
    - https://www.ruby-lang.org/en/news/2019/10/01/ruby-2-5-7-released
    - https://www.ruby-lang.org/en/news/2019/10/01/ruby-2-4-8-released
    - https://www.ruby-lang.org/en/news/2019/10/01/code-injection-shell-test-cve-2019-16255
    - https://seclists.org/bugtraq/2019/Dec/31
    - https://seclists.org/bugtraq/2019/Dec/32
    - https://www.debian.org/security/2019/dsa-4587
    - https://lists.debian.org/debian-lts-announce/2019/11/msg00025.html
    - http://lists.opensuse.org/opensuse-security-announce/2020-03/msg00041.html
    - https://security.gentoo.org/glsa/202003-06
    - https://www.oracle.com/security-alerts/cpujan2020.html
    - https://hackerone.com/reports/327512
    - https://github.com/jruby/jruby/releases/tag/9.3.0.0
    - https://github.com/jruby/jruby/issues/5126
    - https://lists.debian.org/debian-lts-announce/2019/12/msg00009.html
    - https://lists.debian.org/debian-lts-announce/2020/08/msg00027.html
    - https://lists.debian.org/debian-lts-announce/2023/04/msg00033.html
    - https://github.com/advisories/GHSA-ph7w-p94x-9vvw
