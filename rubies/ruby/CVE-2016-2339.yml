---
engine: ruby
cve: 2016-2339
ghsa: c4w7-m676-pcvp
url: https://nvd.nist.gov/vuln/detail/CVE-2016-2339
title: Ruby 2.1 has exploitable heap overflow vulnerability
date: 2017-01-06
description: |
  An exploitable heap overflow vulnerability exists in the
  Fiddle::Function.new "initialize" function functionality of
  Ruby. In Fiddle::Function.new "initialize" heap buffer
  "arg_types" allocation is made based on args array length.
  Specially constructed object passed as element of args array
  can increase this array size after mentioned allocation and
  cause heap overflow.

  Versions affected:
    - Ruby "2.0.0-p648, 2.1.0-p0 through 2.1.9, and 2.2.0 through 2.2.5."
      - NOTE: Unclear where the patches where applied.
    - "Fix was introduced in Ruby 2.1.9, with related packages like
       ruby2.1 updated to version 2.1.9-19.3.2 or newer"
cvss_v3: 9.8
patched_versions:
  - ">= 2.1.9"
related:
  url:
    - https://nvd.nist.gov/vuln/detail/CVE-2016-2339
    - https://app.opencve.io/cve/CVE-2016-2339
    - http://www.talosintelligence.com/reports/TALOS-2016-0034
    - https://lists.debian.org/debian-lts-announce/2018/07/msg00012.html
    - https://web.archive.org/web/20210123144757/https://www.securityfocus.com/bid/91234
    - https://www.cybersecurity-help.cz/vulnerabilities/39952/
    - https://github.com/advisories/GHSA-c4w7-m676-pcvp
