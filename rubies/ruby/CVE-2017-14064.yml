---
engine: ruby
cve: 2017-14064
ghsa: 954h-8gv7-2q75
url: https://nvd.nist.gov/vuln/detail/CVE-2017-14064
title: Heap exposure vulnerability in generating JSON
date: 2017-09-14
description: |
  There is a heap exposure vulnerability in JSON bundled by Ruby.

  The generate method of JSON module optionally accepts an instance of
  JSON::Ext::Generator::State class. If a malicious instance is passed, the
  result may include contents of heap.  All users running an affected release
  should either upgrade or use one of the workarounds immediately.

  The JSON library is also distributed as a gem. If you canâ€™t upgrade Ruby
  itself, install JSON gem newer than version 2.0.4.
cvss_v2: 7.5
cvss_v3: 9.8
patched_versions:
  - "~> 2.2.8"
  - "~> 2.3.5"
  - ">= 2.4.2"
related:
  url:
    - https://nvd.nist.gov/vuln/detail/CVE-2017-14064
    - https://www.ruby-lang.org/en/news/2017/09/14/ruby-2-2-8-released
    - https://www.ruby-lang.org/en/news/2017/09/14/ruby-2-3-5-released
    - https://www.ruby-lang.org/en/news/2017/09/14/ruby-2-4-2-released
    - https://www.ruby-lang.org/en/news/2017/09/14/json-heap-exposure-cve-2017-14064
    - https://github.com/ruby/json/commit/8f782fd8e181d9cfe9387ded43a5ca9692266b85
    - https://bugs.ruby-lang.org/issues/13853
    - https://hackerone.com/reports/209949
    - https://www.debian.org/security/2017/dsa-3966
    - https://lists.debian.org/debian-lts-announce/2018/07/msg00012.html
    - https://ubuntu.com/security/notices/USN-3685-1
    - https://security.gentoo.org/glsa/201710-18
    - https://access.redhat.com/errata/RHSA-2017:3485
    - https://access.redhat.com/errata/RHSA-2018:0378
    - https://access.redhat.com/errata/RHSA-2018:0583
    - https://access.redhat.com/errata/RHSA-2018:0585
    - https://github.com/advisories/GHSA-954h-8gv7-2q75
