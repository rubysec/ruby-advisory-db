---
engine: mruby
cve: 2020-15866
url: https://github.com/mruby/mruby/issues/5042
title: Heap buffer overflow in mruby interpreter
date: 2020-07-21
description: |
  muby through 2.1.2-rc has a heap-based buffer overflow in the
  mrb_yield_with_class function in vm.c because of incorrect VM
  stack handling. It can be triggered via the stack_copy function.
cvss_v2: 7.5
cvss_v3: 9.8
patched_versions:
  - "~> 3.0.0-preview"
  - ">= 3.0.0"
related:
  url:
    - https://nvd.nist.gov/vuln/detail/CVE-2020-15866
    - https://github.com/mruby/mruby/issues/5042
    - https://lists.debian.org/debian-lts-announce/2022/05/msg00006.html
    - https://github.com/advisories/GHSA-4f9x-p86g-x88m
    - https://github.com/mruby/mruby/commit/6334949ba69363cb909a57d6871895bd6d98bb6b
