---
engine: mruby
cve: 2021-46020
ghsa: f639-3h6h-vr46
url: https://github.com/advisories/GHSA-f639-3h6h-vr46
title: An untrusted pointer dereference in mrb_vm_exec() of mruby 3.0.0
date: 2022-01-14
description: |
  An untrusted pointer dereference in mrb_vm_exec() of mruby v3.0.0
  can lead to a segmentation fault or application crash.

  ## PATCH INFO

  - Mruby #5613 described the issue and Matz cited #5619 and #5620
    as "been addressed" on 2/16/2022.
  - Found the #5619 commit on 12/31/2021 in 3.1.0-rc release.
  - Found the #5620 commit on  1/02/2022 in 3.1.0-rc release.
  - 3.1.0-rc was released on 1/17/2022.
cvss_v2: 5.0
cvss_v3: 7.3
patched_versions:
  - ">= 3.1.0-rc"
related:
  url:
    - https://github.com/advisories/GHSA-f639-3h6h-vr46
    - https://nvd.nist.gov/vuln/detail/CVE-2021-46020
    - https://mruby.org/releases/2022/03/12/mruby-3.1.0-released.html
    - https://github.com/mruby/mruby/blob/master/doc/mruby3.1.md
    - https://github.com/mruby/mruby/issues/5613
    - https://github.com/mruby/mruby/pull/5619
    - https://github.com/mruby/mruby/pull/5619/commits/a137ef12f981b517f1e6b64e39edc7ac15d7e1eb
    - https://github.com/mruby/mruby/pull/5620
    - https://github.com/mruby/mruby/pull/5620/commits/d3b7601af96c9e0eeba4c89359289661c755a74a
    - https://github.com/mruby/mruby/commit/7f40b645d2773c8f50c48ae4adf90488e164da55
