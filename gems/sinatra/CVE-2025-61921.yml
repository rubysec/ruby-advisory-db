---
gem: sinatra
cve: 2025-61921
ghsa: mr3q-g2mv-mr4q
url: https://github.com/sinatra/sinatra/security/advisories/GHSA-mr3q-g2mv-mr4q
title: Sinatra is vulnerable to ReDoS through ETag header value generation
date: 2025-10-10
description: |
  ### Summary

  There is a denial of service vulnerability in the `If-Match` and
  `If-None-Match` header parsing component of Sinatra, if the `etag`
  method is used when constructing the response and you are using Ruby < 3.2.

  ### Details

  Carefully crafted input can cause `If-Match` and `If-None-Match`
  header parsing in Sinatra to take an unexpected amount of time,
  possibly resulting in a denial of service attack vector. This header
  is typically involved in generating the `ETag` header value. Any
  applications that use the `etag` method when generating a response
  are impacted if they are using Ruby below version 3.2.

  ### Resources

  * https://github.com/sinatra/sinatra/issues/2120 (report)
  * https://github.com/sinatra/sinatra/pull/2121 (fix)
  * https://github.com/sinatra/sinatra/pull/1823 (older ReDoS vulnerability)
  * https://bugs.ruby-lang.org/issues/19104 (fix in Ruby >= 3.2)
patched_versions:
  - ">= 4.2.0"
related:
  url:
    - https://github.com/sinatra/sinatra/security/advisories/GHSA-mr3q-g2mv-mr4q
    - https://github.com/sinatra/sinatra/issues/2120
    - https://github.com/sinatra/sinatra/pull/1823
    - https://github.com/sinatra/sinatra/pull/2121
    - https://github.com/sinatra/sinatra/commit/3fe8c38dc405586f7ad8f2ac748aa53e9c3615bd
    - https://github.com/sinatra/sinatra/commit/8ff496bd4877520599e1479d6efead39304edceb
    - https://bugs.ruby-lang.org/issues/19104
    - https://github.com/advisories/GHSA-mr3q-g2mv-mr4q
