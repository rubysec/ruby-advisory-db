---
gem: sanitize
cve: 2018-3740
ghsa: 7f42-p84j-f58p
url: https://github.com/rgrove/sanitize/issues/176
title: HTML injection/XSS in Sanitize
date: 2018-03-19
description: |
  When Sanitize gem is used in combination with libxml2 >= 2.9.2,
  a specially crafted HTML fragment can cause libxml2 to generate
  improperly escaped output, allowing non-whitelisted attributes to be
  used on whitelisted elements.

  This can allow HTML and JavaScript injection, which could result in XSS
  if Sanitize's output is served to browsers.
unaffected_versions:
- < 1.1.0
patched_versions:
- ~> 2.1.1
- '>= 4.6.3'
related:
  url:
  - https://github.com/rgrove/sanitize/commit/01629a162e448a83d901456d0ba8b65f3b03d46e
