---
gem: rack
cve: 2026-22860
ghsa: mxw3-3hh2-x2mh
url: https://github.com/rack/rack/security/advisories/GHSA-mxw3-3hh2-x2mh
title: Rack::Directory vulnerable to path traversal when serving files
date: 2026-01-16
description: |
  ## Summary

  `Rack::Directory` is vulnerable to path traversal. An attacker can
  request crafted paths and access files outside the configured root.

  ## Details

  The vulnerability is in `Rack::Directory` path handling. Directory
  traversal sequences are not sufficiently constrained before file
  resolution, which can allow escaping the intended base directory.

  Affected versions:

  - `< 2.2.22`
  - `>= 3.0.0.beta1, < 3.1.20`
  - `>= 3.2.0.beta1, < 3.2.5`

  ## Impact

  Applications that expose `Rack::Directory` can disclose arbitrary
  files reachable by the process, including sensitive configuration or
  application data.

  ## Mitigation

  - Upgrade to a patched version of Rack.
  - Avoid exposing `Rack::Directory` to untrusted paths.
patched_versions:
  - ">= 2.2.22"
  - ">= 3.1.20"
  - ">= 3.2.5"
related:
  url:
    - https://github.com/rack/rack/security/advisories/GHSA-mxw3-3hh2-x2mh
    - https://github.com/rack/rack/commit/75c5745c286637a8f049a33790c71237762069e7
    - https://github.com/advisories/GHSA-mxw3-3hh2-x2mh
