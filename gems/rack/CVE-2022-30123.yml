---
gem: rack
cve: 2022-30123
ghsa: wq4h-7r42-5hrr
url: https://groups.google.com/g/ruby-security-ann/c/LWB10kWzag8
title: Possible shell escape sequence injection vulnerability in Rack
date: 2022-06-27
description: |
  There is a possible shell escape sequence injection vulnerability in the Lint
  and CommonLogger components of Rack.  This vulnerability has been assigned the
  CVE identifier CVE-2022-30123.

  Versions Affected:  All.
  Not affected:       None
  Fixed Versions:     2.0.9.1, 2.1.4.1, 2.2.3.1

  ## Impact
  Carefully crafted requests can cause shell escape sequences to be written to
  the terminal via Rack's Lint middleware and CommonLogger middleware.  These
  escape sequences can be leveraged to possibly execute commands in the victim's
  terminal.

  Impacted applications will have either of these middleware installed, and
  vulnerable apps may have something like this:

  ```
  use Rack::Lint
  ```

  Or

  ```
  use Rack::CommonLogger
  ```

  All users running an affected release should either upgrade or use one of the
  workarounds immediately.

  ## Workarounds
  Remove these middleware from your application
cvss_v3: 10.0
patched_versions:
  - "~> 2.0.9, >= 2.0.9.1"
  - "~> 2.1.4, >= 2.1.4.1"
  - ">= 2.2.3.1"
