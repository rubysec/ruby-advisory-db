---
gem: actionmailer
framework: rails
cve: 2024-47889
ghsa: h47h-mwp9-c6q6
url: https://github.com/rails/rails/security/advisories/GHSA-h47h-mwp9-c6q6
title: Possible ReDoS vulnerability in block_format in Action Mailer
date: 2024-10-15
description: |
  There is a possible ReDoS vulnerability in the block_format helper
  in Action Mailer. This vulnerability has been assigned the
  CVE identifier CVE-2024-47889.

  ## Impact

  Carefully crafted text can cause the block_format helper to take an
  unexpected amount of time, possibly resulting in a DoS vulnerability.
  All users running an affected release should either upgrade or apply
  the relevant patch immediately.

  Ruby 3.2 has mitigations for this problem, so Rails applications
  using Ruby 3.2 or newer are unaffected. Rails 8.0.0.beta1 requires
  Ruby 3.2 or greater so is unaffected.

  ## Releases

  The fixed releases are available at the normal locations.

  ## Workarounds

  Users can avoid calling the `block_format` helper or upgrade
  to Ruby 3.2.

  ##Credits

  Thanks to [ooooooo_q](https://hackerone.com/ooooooo_q) for the report!
unaffected_versions:
  - "< 3.0.0"
patched_versions:
  - "~> 6.1.7.9"
  - "~> 7.0.8, >= 7.0.8.5"
  - "~> 7.1.4, >= 7.1.4.1"
  - ">= 7.2.1.1"
related:
  url:
    - https://github.com/rails/rails/security/advisories/GHSA-h47h-mwp9-c6q6
    - https://github.com/advisories/GHSA-h47h-mwp9-c6q6
