---
gem: activesupport
framework: rails
cve: 2023-22796
ghsa: j6gc-792m-qgm2
url: https://github.com/rails/rails/releases/tag/v7.0.4.1
title: ReDoS based DoS vulnerability in Active Supportâ€™s underscore
date: 2023-01-18
description: |
  There is a possible regular expression based DoS vulnerability in Active
  Support. This vulnerability has been assigned the CVE identifier
  CVE-2023-22796.

  Versions Affected: All
  Not affected: None
  Fixed Versions: 5.2.8.15 (Rails LTS), 6.1.7.1, 7.0.4.1

  # Impact

  A specially crafted string passed to the underscore method can cause the
  regular expression engine to enter a state of catastrophic backtracking.
  This can cause the process to use large amounts of CPU and memory, leading
  to a possible DoS vulnerability.

  This affects String#underscore, ActiveSupport::Inflector.underscore,
  String#titleize, and any other methods using these.

  All users running an affected release should either upgrade or use one of the
  workarounds immediately.

  # Workarounds

  There are no feasible workarounds for this issue.

  Users on Ruby 3.2.0 or greater may be able to reduce the impact by
  configuring Regexp.timeout.
patched_versions:
  - "~> 5.2.8, >= 5.2.8.15"  # Rails LTS
  - "~> 6.1.7, >= 6.1.7.1"
  - ">= 7.0.4.1"
