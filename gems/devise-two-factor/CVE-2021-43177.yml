---
gem: devise-two-factor
cve: 2021-43177
ghsa: jm35-h8q2-73mp
url: https://github.com/tinfoil/devise-two-factor/security/advisories/GHSA-jm35-h8q2-73mp
title: Improper one time password handling in devise-two-factor
date: 2022-04-07
description: |
  ### Impact

  As a result of an incomplete fix for CVE-2015-7225, in versions of
  devise-two-factor prior to 4.0.2 it is possible to reuse a One-Time-Password
  (OTP) for one (and only one) immediately trailing interval.

  ### Patches

  This vulnerability has been patched in version 4.0.2 which was released on
  March 24th, 2022. Individuals using this package are strongly encouraged to
  upgrade as soon as possible.
cvss_v3: 5.3
patched_versions:
  - ">= 4.0.2"
related:
  cve:
    - 2015-7225
  url:
    - https://github.com/tinfoil/devise-two-factor/issues/106
