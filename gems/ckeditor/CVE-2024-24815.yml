---
gem: ckeditor
cve: 2024-24815
ghsa: fq6h-4g8v-qqvm
url: https://github.com/ckeditor/ckeditor4/security/advisories/GHSA-fq6h-4g8v-qqvm
title: CKEditor4 Cross-site Scripting vulnerability caused by incorrect CDATA detection
date: 2024-02-07
description: |-
  ### Affected packages
  The vulnerability has been discovered in the core HTML parsing module and may affect all editor instances that:
  * Enabled [full-page editing](https://ckeditor.com/docs/ckeditor4/latest/features/fullpage.html) mode,
  * or enabled [CDATA](https://ckeditor.com/docs/ckeditor4/latest/api/CKEDITOR_dtd.html#property-S-cdata) elements in [Advanced Content Filtering](https://ckeditor.com/docs/ckeditor4/latest/guide/dev_advanced_content_filter.html) configuration (defaults to `script` and `style` elements).

  ### Impact

  A potential vulnerability has been discovered in CKEditor 4 HTML processing core module. The vulnerability allowed to inject malformed HTML content bypassing Advanced Content Filtering mechanism, which could result in executing JavaScript code. An attacker could abuse faulty CDATA content detection and use it to prepare an intentional attack on the editor. It affects all users using the CKEditor 4 at version < 4.24.0-lts.

  ### Patches
  The problem has been recognized and patched. The fix will be available in version 4.24.0-lts.

  ### For more information
  Email us at [security@cksource.com](mailto:security@cksource.com) if you have any questions or comments about this advisory.

  ### Acknowledgements
  The CKEditor 4 team would like to thank [Michal FrÃ½ba](https://cz.linkedin.com/in/michal-fryba) from [ALEF NULA](https://www.alefnula.com/) for recognizing and reporting this vulnerability.
cvss_v3: 6.1
related:
  url:
  - https://github.com/ckeditor/ckeditor4/security/advisories/GHSA-fq6h-4g8v-qqvm
  - https://github.com/ckeditor/ckeditor4/commit/8ed1a3c93d0ae5f49f4ecff5738ab8a2972194cb
  - https://ckeditor.com/docs/ckeditor4/latest/api/CKEDITOR_dtd.html#property-S-cdata
  - https://ckeditor.com/docs/ckeditor4/latest/features/fullpage.html
  - https://ckeditor.com/docs/ckeditor4/latest/guide/dev_advanced_content_filter.html
  - https://nvd.nist.gov/vuln/detail/CVE-2024-24815
  - https://www.drupal.org/sa-contrib-2024-009
  - https://github.com/advisories/GHSA-fq6h-4g8v-qqvm
