---
gem: spree_api
cve: 2026-22588
ghsa: g268-72p7-9j6j
url: https://github.com/spree/spree/security/advisories/GHSA-g268-72p7-9j6j
title: Spree API has Authenticated Insecure Direct Object Reference
  (IDOR) via Order Modification
date: 2026-01-08
description: |
  ### Summary

  An Authenticated Insecure Direct Object Reference (IDOR)
  vulnerability was identified that allows an authenticated user to
  retrieve other users’ address information by modifying an existing order.
  By editing an order they legitimately own and manipulating address
  identifiers in the request, the backend server accepts and processes
  references to addresses belonging to other users, subsequently
  associating those addresses with the attacker’s order and returning
  them in the response.

  ### Details

  Affected Component(s)

  - Authenticated user order management
  - Address association logic
  - Order update endpoint(s)

  Affected Endpoint(s):
  - `/api/v2/storefront/checkout`

  The application fails to enforce proper object-level authorization
  when updating an existing order. While the user is authenticated and
  authorized to modify their own order, the backend does not verify
  that the supplied address identifiers belong to the same authenticated user.

  **See reference below for POC.**

  ### Impact

  As a result, an attacker can:
  - Replace the address identifier with one belonging to another user
  - Cause the backend to associate and return another user’s address
    within the attacker’s order"
cvss_v3: 6.5
unaffected_versions:
  - "< 3.7.0"
patched_versions:
  - "~> 4.10.2"
  - "~> 5.0.7"
  - "~> 5.1.9"
  - ">= 5.2.5"
related:
  url:
    - https://nvd.nist.gov/vuln/detail/CVE-2026-22588
    - https://github.com/spree/spree/security/advisories/GHSA-g268-72p7-9j6j
    - https://github.com/spree/spree/commit/02acabdce2c5f14fd687335b068d901a957a7e72
    - https://github.com/spree/spree/commit/17e78a91b736b49dbea8d1bb1223c284383ee5f3
    - https://github.com/spree/spree/commit/b409c0fd327e7ce37f63238894670d07079eefe8
    - https://github.com/spree/spree/commit/d3f961c442e0015661535cbd6eb22475f76d2dc7
    - https://github.com/advisories/GHSA-g268-72p7-9j6j
